{% extends "layouts/with_leftbar/base.html" %}
{% load static %}
{% load gene_detail %}
{% csrf_token %}
{% block addon_css %}
    <link rel="stylesheet" href="{% static 'home/css/jquery.dataTables.min.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'home/css/bootstrap2-toggle.min.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'home/css/yadcf_bootstrap_version.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'home/css/select2.css' %}" type="text/css"/>
    <link rel="stylesheet" href="{% static 'home/css/modal.css' %}" type="text/css"/>
    <!--This is for the filter, min max, pagination styling -->
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.16/b-1.5.1/b-html5-1.5.1/datatables.min.css"/>
    <link rel="stylesheet" href="{% static 'home/css/construct_browser.css' %}" type="text/css"/>

    <link rel="stylesheet" href="{% static 'gene/css/gene-detail.css' %}" type="text/css"/>
{% endblock addon_css %}


{% block content %}
    {% autoescape off %}
<<<<<<< HEAD

        <div style="padding-top: 0px; font-size: 14px; white-space: nowrap; overflow-y:hidden; width: 100%">
            <br/>

            {% include '_buttons.html' %}

            <div id="structures_scrollable_table">
                <table class="display compact text-nowrap" id="structures_scrollable"
                       style="width: 100%; margin-top: 10px; font-size: 12px;">
                    <thead id="headers">
                    <tr class="header-spans">
                        <th style="text-align:left" colspan="8">Position</th>
                        <th style="border-left: 1px solid black; text-align:left" colspan="2" style="">Impact</th>
                        <th style="border-left: 1px solid black; text-align:left" colspan="40"> Predicted effect
                            scores
                        </th>
                    </tr>

                    <tr class="table-filter-dropdown">
                        <!-- Position block -->

                        <!-- This should be rewrote using templatetag -->
                        <th style="text-align: left; width:150px">Variant</th>
                        <th style="text-align: left">Transcript</th>
                        <th style="text-align: left">cDNA_</br>position</th>
                        <th style="text-align: left">CDS_</br>position</th>
                        <th style="text-align: left">Protein_</br>position</th>
                        <th style="text-align: left">Amino_</br>acids</th>
                        <th style="text-align: left">Codons</th>
                        <th style="text-align: left">Strand</th>
                        <!-- Impact block -->
                        <th style="text-align: left">Conse_</br>quence</th>
                        <th style="text-align: left">Impact</th>
                        <!-- Score block -->
                        <th style="text-align: left">BayesDel_</br>addAF</th>
                        <th style="text-align: left">BayesDel_</br>noAF</th>
                        <th style="text-align: left">CADD_</br>raw</th>
                        <th style="text-align: left">ClinPred</th>
                        <th style="text-align: left">DANN</th>

                        <th style="text-align: left">DEOGEN2</th>
                        <th style="text-align: left">Eigen_PC_</br>raw_coding</th>
                        <th style="text-align: left">Eigen_raw_</br>coding</th>
                        <th style="text-align: left">FATHMM_</br>converted</th>
                        <th style="text-align: left">GERP_RS</th>

                        <th style="text-align: left">GM12878_</br>fitCons</th>
                        <th style="text-align: left">Geno</br>Canyon</th>
                        <th style="text-align: left">H1_hESC_</br>fitCons</th>
                        <th style="text-align: left">HUVEC_</br>fitCons</th>
                        <th style="text-align: left">LIST_S2</th>

                        <th style="text-align: left">LRT_</br>converted</th>
                        <th style="text-align: left">M_CAP</th>
                        <th style="text-align: left">MPC</th>
                        <th style="text-align: left">MVP</th>
                        <th style="text-align: left">MetaLR</th>

                        <th style="text-align: left">MetaRNN</th>
                        <th style="text-align: left">MetaSVM</th>
                        <th style="text-align: left">MutPred</th>
                        <th style="text-align: left">Mutation</br>Assessor</th>
                        <th style="text-align: left">Mutation</br>Taster_</br>converted</th>

                        <th style="text-align: left">PROVEAN_</br>converted</th>
                        <th style="text-align: left">Polyphen2_</br>HDIV</th>
                        <th style="text-align: left">Polyphen2_</br>HVAR</th>
                        <th style="text-align: left">PrimateAI</th>
                        <th style="text-align: left">REVEL</th>

                        <th style="text-align: left">SIFT4G_</br>converted</th>
                        <th style="text-align: left">SIFT_</br>converted</th>
                        <th style="text-align: left">SiPhy_</br>29way_</br>logOdds</th>
                        <th style="text-align: left">VEST4</th>
                        <th style="text-align: left">bStatistic</br>converted</th>

                        <th style="text-align: left">Fathmm_</br>MKL_coding</th>
                        <th style="text-align: left">Fathmm_XF</br>_coding</th>
                        <th style="text-align: left">Integrated_</br>fitCons</th>
                        <th style="text-align: left">PhastCons</br>30way_</br>mammalian</th>
                        <th style="text-align: left">Phylo_</br>P30way_</br>mammalian</th>
                    </tr>

                    </thead>
                    <tbody id='structures_scrollable_body'>
                    {% comment %} {% for value in array|slice:":12" %} {% endcomment %}
                    {% for value in array %}
                        <tr>
                            <!-- This should be rewrote using templatetag -->
                            <td style="text-align: left">{{ value.0 }}</td>
                            <td style="text-align: left">{{ value.1 }}</td>
                            <td style="text-align: left">{{ value.3 }}</td>
                            <td style="text-align: left">{{ value.4 }}</td>
                            <td style="text-align: left">{{ value.5 }}</td>
                            <td style="text-align: left">{{ value.6 }}</td>
                            <td style="text-align: left">{{ value.7 }}</td>
                            <td style="text-align: left">{{ value.9 }}</td>
                            <td style="text-align: left">{{name_dic|keyvalue:value.2}}</td>
                            <td style="text-align: left">{{name_dic|keyvalue:value.8}}</td>

                            <!-- This should be rewrote using templatetag -->

                        {% render_variant_value value.10 %}
                        {% render_variant_value value.11 %}
                        {% render_variant_value value.12 %}
                        {% render_variant_value value.13 %}
                        {% render_variant_value value.14 %}
                        {% render_variant_value value.15 %}
                        {% render_variant_value value.16 %}
                        {% render_variant_value value.17 %}
                        {% render_variant_value value.18 %}
                        {% render_variant_value value.19 %}
                        {% render_variant_value value.20 %}
                        {% render_variant_value value.21 %}
                        {% render_variant_value value.22 %}
                        {% render_variant_value value.23 %}
                        {% render_variant_value value.24 %}
                        {% render_variant_value value.25 %}
                        {% render_variant_value value.26 %}
                        {% render_variant_value value.27 %}
                        {% render_variant_value value.28 %}
                        {% render_variant_value value.29 %}
                        {% render_variant_value value.30 %}
                        {% render_variant_value value.31 %}
                        {% render_variant_value value.32 %}
                        {% render_variant_value value.33 %}
                        {% render_variant_value value.34 %}
                        {% render_variant_value value.35 %}
                        {% render_variant_value value.36 %}
                        {% render_variant_value value.37 %}
                        {% render_variant_value value.38 %}
                        {% render_variant_value value.39 %}
                        {% render_variant_value value.40 %}
                        {% render_variant_value value.41 %}
                        {% render_variant_value value.42 %}
                        {% render_variant_value value.43 %}
                        {% render_variant_value value.44 %}
                        {% render_variant_value value.45 %}
                        {% render_variant_value value.46 %}
                        {% render_variant_value value.47 %}
                        {% render_variant_value value.48 %}
                        {% render_variant_value value.49 %}

                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <br/>
=======
        <div class="row">
            <div class="col-md-3">
                {{ filter_form }}
>>>>>>> b67ca38ea11c2c2f9ce0f2df9626eb6c6a74ac01
            </div>
            <div class="col-md-9">
                <div class="gene-table-container">
                    {% include '_buttons.html' %}
                    <div id="structures_scrollable_table">
                        <table class="display compact text-nowrap" id="structures_scrollable">
                            <thead id="headers">
                            <tr class="table-filter-dropdown">
                                <th style="text-align: left; width:150px">Variant</th>
                                <th>Transcript</th>
                                <th>cDNA_</br>position</th>
                                <th>CDS_</br>position</th>
                                <th>Protein_</br>position</th>
                                <th>Amino_</br>acids</th>
                                <th>Codons</th>
                                <th>Strand</th>
                                <!-- Impact block -->
                                <th>Conse_</br>quence</th>
                                <th>Impact</th>
                                <!-- Score block -->
                                <th>BayesDel_</br>addAF</th>
                                <th>BayesDel_</br>noAF</th>
                                <th>CADD_</br>raw</th>
                                <th>ClinPred</th>
                                <th>DANN</th>

                                <th>DEOGEN2</th>
                                <th>Eigen_PC_</br>raw_coding</th>
                                <th>Eigen_raw_</br>coding</th>
                                <th>FATHMM_</br>converted</th>
                                <th>GERP_RS</th>

                                <th>GM12878_</br>fitCons</th>
                                <th>Geno</br>Canyon</th>
                                <th>H1_hESC_</br>fitCons</th>
                                <th>HUVEC_</br>fitCons</th>
                                <th>LIST_S2</th>

                                <th>LRT_</br>converted</th>
                                <th>M_CAP</th>
                                <th>MPC</th>
                                <th>MVP</th>
                                <th>MetaLR</th>

                                <th>MetaRNN</th>
                                <th>MetaSVM</th>
                                <th>MutPred</th>
                                <th>Mutation</br>Assessor</th>
                                <th>Mutation</br>Taster_</br>converted</th>

                                <th>PROVEAN_</br>converted</th>
                                <th>Polyphen2_</br>HDIV</th>
                                <th>Polyphen2_</br>HVAR</th>
                                <th>PrimateAI</th>
                                <th>REVEL</th>

                                <th>SIFT4G_</br>converted</th>
                                <th>SIFT_</br>converted</th>
                                <th>SiPhy_</br>29way_</br>logOdds</th>
                                <th>VEST4</th>
                                <th>bStatistic</br>converted</th>

                                <th>Fathmm_</br>MKL_coding</th>
                                <th>Fathmm_XF</br>_coding</th>
                                <th>Integrated_</br>fitCons</th>
                                <th>PhastCons</br>30way_</br>mammalian</th>
                                <th>Phylo_</br>P30way_</br>mammalian</th>
                            </tr>

                            </thead>
                            <tbody id='structures_scrollable_body'>
                            {% for value in array %}
                                <tr>
                                    <td class="align-left">{{ value.0 }}</td>
                                    <td class="align-left">{{ value.1 }}</td>
                                    <td class="align-left">{{ value.3 }}</td>
                                    <td class="align-left">{{ value.4 }}</td>
                                    <td class="align-left">{{ value.5 }}</td>
                                    <td class="align-left">{{ value.6 }}</td>
                                    <td class="align-left">{{ value.7 }}</td>
                                    <td class="align-left">{{ value.9 }}</td>
                                    <td class="align-left">{{ name_dic.value.2 }}</td>
                                    <td class="align-left">{{ name_dic.value.8 }}</td>

                                    {% render_variant_value value.10 %}
                                    {% render_variant_value value.11 %}
                                    {% render_variant_value value.12 %}
                                    {% render_variant_value value.13 %}
                                    {% render_variant_value value.14 %}
                                    {% render_variant_value value.15 %}
                                    {% render_variant_value value.16 %}
                                    {% render_variant_value value.17 %}
                                    {% render_variant_value value.18 %}
                                    {% render_variant_value value.19 %}
                                    {% render_variant_value value.20 %}
                                    {% render_variant_value value.21 %}
                                    {% render_variant_value value.22 %}
                                    {% render_variant_value value.23 %}
                                    {% render_variant_value value.24 %}
                                    {% render_variant_value value.25 %}
                                    {% render_variant_value value.26 %}
                                    {% render_variant_value value.27 %}
                                    {% render_variant_value value.28 %}
                                    {% render_variant_value value.29 %}
                                    {% render_variant_value value.30 %}
                                    {% render_variant_value value.31 %}
                                    {% render_variant_value value.32 %}
                                    {% render_variant_value value.33 %}
                                    {% render_variant_value value.34 %}
                                    {% render_variant_value value.35 %}
                                    {% render_variant_value value.36 %}
                                    {% render_variant_value value.37 %}
                                    {% render_variant_value value.38 %}
                                    {% render_variant_value value.39 %}
                                    {% render_variant_value value.40 %}
                                    {% render_variant_value value.41 %}
                                    {% render_variant_value value.42 %}
                                    {% render_variant_value value.43 %}
                                    {% render_variant_value value.44 %}
                                    {% render_variant_value value.45 %}
                                    {% render_variant_value value.46 %}
                                    {% render_variant_value value.47 %}
                                    {% render_variant_value value.48 %}
                                    {% render_variant_value value.49 %}
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                        <br/>
                    </div>
                </div>
            </div>
        </div>
    {% endautoescape %}
{% endblock content %}

{% block addon_js %}
    <script src="{% static 'home/js/datatables.min.js' %}"></script>
    <script src="{% static 'home/js/bootstrap2-toggle.min.js' %}"></script>
    <script src="{% static 'home/js/jquery.dataTables.yadcf.js' %}"></script>
    <script src="{% static 'home/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'home/js/select2.js' %}"></script>
    <script src="{% static 'home/js/grayscale.js' %}"></script>
    <script src="{% static 'home/js/gpcrdb.js' %}"></script>
    <script src="{% static 'home/js/signprot-multitabtable.js' %}"></script>
    <script src="{% static 'gene/js/table-filter.js' %}"></script>


    <script>
        $(document).ready(function () {
                $("#id_mean_vep_score").on('change', function () {
                        // let table = $('#structures_table').DataTable();
                        // table.draw();
                        let url = "{% url 'gene:filter-gene-detail-page' gene.gene_id %}";
                        let mean_vep_score = $("#id_mean_vep_score").val();
                        console.log("mean_vep_score: " + mean_vep_score);
                        console.log("url: " + url);

                        $.get(
                            {
                                url: "{% url 'gene:filter-gene-detail-page' gene.gene_id %}",
                                data: {
                                    'mean_vep_score': mean_vep_score,
                                },
                                success: function (data) {
                                    console.log("success");
                                    console.log(data);
                                    $("#structures_scrollable_body").html(data);
                                },
                            }
                        )
                    }
                )
            }
        )
    </script>
{% endblock addon_js %}